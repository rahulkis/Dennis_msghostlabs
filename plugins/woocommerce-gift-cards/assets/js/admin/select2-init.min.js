jQuery(function(e){function t(e){e.on("select2:unselecting",function(){e.data("unselecting",!0)}).on("select2:opening",function(t){e.data("unselecting")&&(e.removeData("unselecting"),t.preventDefault())})}function a(t,a){if(t.data("sortable")&&t.prop("multiple")){var n=t.next(".select2-container").find("ul.select2-selection__rendered");a=a||{},n.sortable({placeholder:"ui-state-highlight select2-selection__choice",forcePlaceholderSize:!0,items:"li:not(.select2-search__field)",tolerance:"pointer",stop:function(){e(n.find(".select2-selection__choice").get().reverse()).each(function(){var e=c.GetData(this,"data").id,n=t.find('option[value="'+e+'"]')[0];t.prepend(n),"function"==typeof a.stop&&a.stop(t)})}})}}function n(e){!e.data("sortable")&&e.prop("multiple")&&e.on("change",function(){var t=e.children();t.sort(function(e,t){var a=e.text.toLowerCase(),n=t.text.toLowerCase();return a>n?1:a<n?-1:0}),e.html(t)})}var c=e.fn.selectSW.amd.require("selectSW/utils"),s={language:{errorLoading:function(){return wc_enhanced_select_params.i18n_searching},inputTooLong:function(e){var t=e.input.length-e.maximum;return 1===t?wc_enhanced_select_params.i18n_input_too_long_1:wc_enhanced_select_params.i18n_input_too_long_n.replace("%qty%",t)},inputTooShort:function(e){var t=e.minimum-e.input.length;return 1===t?wc_enhanced_select_params.i18n_input_too_short_1:wc_enhanced_select_params.i18n_input_too_short_n.replace("%qty%",t)},loadingMore:function(){return wc_enhanced_select_params.i18n_load_more},maximumSelected:function(e){return 1===e.maximum?wc_enhanced_select_params.i18n_selection_too_long_1:wc_enhanced_select_params.i18n_selection_too_long_n.replace("%qty%",e.maximum)},noResults:function(){return wc_enhanced_select_params.i18n_no_matches},searching:function(){return wc_enhanced_select_params.i18n_searching}}};e.fn.sw_select2=function(c){e(":input.sw-select2",this).filter(":not(.sw-select2--initialized)").each(function(){var n=e(this),c=n.data("wrap"),i={minimumResultsForSearch:10,allowClear:!!n.data("allow_clear"),placeholder:n.data("placeholder"),closeOnSelect:!0};c&&(c="yes"!==c?"sw-select2-wrap-"+c.toString():"sw-select2-wrap",n.wrap('<div class="'+c+'"></div>')),i=e.extend(i,s),n.selectSW(i).addClass("sw-select2--initialized"),t(n),a(n)}),e(":input.sw-select2-search--products",this).filter(":not(.sw-select2--initialized)").each(function(){var i=e(this),l=i.data("wrap"),r={cache:!0,allowClear:!!i.data("allow_clear"),placeholder:i.data("placeholder"),minimumInputLength:i.data("minimum_input_length")?i.data("minimum_input_length"):"3",escapeMarkup:function(e){return e},ajax:{url:wc_enhanced_select_params.ajax_url,dataType:"json",delay:250,data:function(e){return{term:e.term,action:i.data("action")||"woocommerce_json_search_products_and_variations",security:wc_enhanced_select_params.search_products_nonce,exclude:i.data("exclude"),include:i.data("include"),limit:i.data("limit")}},processResults:function(t){var a=[];return"woocommerce_json_search_products_and_variations_in_component"===t.action&&("yes"===i.data("component_optional")&&a.push({id:"-1",text:wc_composite_admin_params.i18n_none}),a.push({id:"0",text:wc_composite_admin_params.i18n_all})),t&&e.each(t,function(e,t){a.push({id:e,text:t})}),{results:a}}}};l&&(l="yes"!==l?"sw-select2-wrap-"+l.toString():"sw-select2-wrap",i.wrap('<div class="'+l+'"></div>')),r=e.extend(r,s),i.selectSW(r).addClass("sw-select2--initialized"),t(i),a(i,c&&c.sortable?c.sortable:{}),n(i)}),e(":input.sw-select2-search--categories",this).filter(":not(.sw-select2--initialized)").each(function(){var t=e(this),a=t.data("wrap"),n={cache:!0,allowClear:!!t.data("allow_clear"),placeholder:t.data("placeholder"),minimumInputLength:t.data("minimum_input_length")?t.data("minimum_input_length"):3,escapeMarkup:function(e){return e},ajax:{url:wc_enhanced_select_params.ajax_url,dataType:"json",delay:250,data:function(e){return{term:e.term,action:"woocommerce_json_search_categories",security:wc_enhanced_select_params.search_categories_nonce}},processResults:function(t){var a=[];return t&&e.each(t,function(e,t){a.push({id:t.slug,text:t.formatted_name})}),{results:a}}}};a&&(a="yes"!==a?"sw-select2-wrap-"+a.toString():"sw-select2-wrap",t.wrap('<div class="'+a+'"></div>')),n=e.extend(n,s),t.selectSW(n).addClass("sw-select2--initialized")}),e(".sw-select2-search--customers",this).filter(":not(.sw-select2--initialized)").each(function(){var t=e(this),a=t.data("wrap"),n={cache:!0,allowClear:!!t.data("allow_clear"),placeholder:t.data("placeholder"),minimumInputLength:t.data("minimum_input_length")?t.data("minimum_input_length"):3,escapeMarkup:function(e){return e},ajax:{url:wc_enhanced_select_params.ajax_url,dataType:"json",delay:1e3,data:function(e){return{term:e.term,action:"woocommerce_json_search_customers",security:wc_enhanced_select_params.search_customers_nonce,exclude:t.data("exclude")}},processResults:function(t){var a=[];return t&&e.each(t,function(e,t){a.push({id:e,text:t})}),{results:a}},cache:!0}};a&&(a="yes"!==a?"sw-select2-wrap-"+a.toString():"sw-select2-wrap",t.wrap('<div class="'+a+'"></div>')),n=e.extend(n,s),t.selectSW(n).addClass("sw-select2--initialized")}),e(document.body).trigger("sw-select2-init")},e("html").on("wc_backbone_modal_before_remove",function(){e(".sw-select2, :input.sw-select2-search--products").filter(".select2-hidden-accessible").selectSW("close")}).on("click",function(t){this===t.target&&e(".sw-select2, :input.sw-select2-search--products").filter(".select2-hidden-accessible").selectSW("close")}),e(document.body).find(".sw-select2-autoinit").each(function(){e(this).sw_select2()})});