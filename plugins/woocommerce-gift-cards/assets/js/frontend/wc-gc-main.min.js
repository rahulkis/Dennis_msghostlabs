!function(e,t){function c(e,t){return new Date(e.getTime()+6e4*t)}e(function(){var c=function(e){return wc_gc_params.wc_ajax_url.toString().replace("%%endpoint%%",e)},a=function(e){return e.is(".processing")||e.parents(".processing").length},r=function(e){a(e)||e.addClass("processing").block({message:null,overlayCSS:{background:"#fff",opacity:.6}})},_=function(e){e.removeClass("processing").unblock()},n=function(c){e(".cart_totals").replaceWith(c),e(t.body).trigger("updated_cart_totals")};e("div.cart-collaterals").on("change","#use_gift_card_balance",function(){var t=!0===e(this).is(":checked")?"on":"off";r(e("div.cart_totals")),e.ajax({type:"post",url:c("toggle_balance_usage"),data:"wc_gc_use_balance="+t+"&security="+wc_gc_params.security_update_use_balance_nonce,dataType:"html",success:function(t){_(e("div.cart_totals")),n(t)}})}),e("div.cart-collaterals").on("click",".wc_gc_remove_gift_card",function(t){t.preventDefault();var a=e(this).data("giftcard");return r(e("div.cart_totals")),e.ajax({type:"post",url:c("remove_gift_card_from_session"),data:"wc_gc_cart_id="+a+"&render_cart_fragments=1&security="+wc_gc_params.security_remove_card_nonce,dataType:"html",success:function(t){_(e("div.cart_totals")),n(t)}}),!1}),e("#order_review").on("click",".wc_gc_remove_gift_card",function(c){c.preventDefault();var a=e(this).data("giftcard");if(a){var r=e("<input />");r.prop("type","hidden"),r.prop("class","wc_gc_cart_remove_giftcards"),r.prop("name","wc_gc_cart_remove_giftcards"),r.appendTo("#order_review"),r.val(a),e(t.body).trigger("update_checkout"),setTimeout(function(){r.remove()},500)}return!1}),e("#order_review").on("click","#wc_gc_cart_redeem_send",function(c){c.preventDefault(),e("#wc_gc_cart_code").val()&&e(t.body).trigger("update_checkout")}),e("div.cart-collaterals").on("click","#wc_gc_cart_redeem_send",function(t){t.preventDefault();var a=e("#wc_gc_cart_code").val();if(a)return r(e("div.cart_totals")),e.ajax({type:"post",url:c("apply_gift_card_to_session"),data:"wc_gc_cart_code="+a+"&security="+wc_gc_params.security_redeem_card_nonce,dataType:"html",success:function(t){_(e("div.cart_totals")),n(t)}}),!1}),e(".woocommerce_gc_giftcard_form").wc_gc_datepickers()}),e.fn.wc_gc_datepickers=function(){e(this).find(".datepicker").each(function(t){var a=e(this),r=a.parent(),_=r.find('input[name="wc_gc_giftcard_delivery"]'),n=r.find('input[name="_wc_gc_giftcard_delivery_gmt_offset"]');n.length||((n=e("<input/>")).attr("type","hidden"),n.attr("name","_wc_gc_giftcard_delivery_gmt_offset"),r.append(n));var i,o=new Date,s=parseFloat(wc_gc_params.gmt_offset,10),d=o.getTimezoneOffset()/60,u=d-s;if("default"===wc_gc_params.date_input_timezone_reference)n.val(d),i="+1D";else if("store"===wc_gc_params.date_input_timezone_reference){var g=o.getHours()+o.getMinutes()/60+u;n.val(s),i=g>=24?"+"+(Math.floor(g/24)+1)+"D":g<=0?0:"+1D"}a.datepicker({beforeShow:function(t,c){e("#ui-datepicker-div").removeClass("wc_gc_datepicker"),e("#ui-datepicker-div").addClass("wc_gc_datepicker")},minDate:i});var f=a.datepicker("getDate");null!==f&&"function"==typeof f.getTime&&(f.setHours(o.getHours(),o.getMinutes()),"store"===wc_gc_params.date_input_timezone_reference&&(f=c(f=c(f,-1*d*60),60*s)),_.val(f.getTime()/1e3)),a.on("change",function(){var e=a.datepicker("getDate");if(null!==e&&"function"==typeof e.getTime){var t=new Date;e.setHours(t.getHours(),t.getMinutes()),"store"===wc_gc_params.date_input_timezone_reference&&(e=c(e=c(e,-1*d*60),60*s)),_.val(e.getTime()/1e3)}else _.val("")})})}}(jQuery,document);