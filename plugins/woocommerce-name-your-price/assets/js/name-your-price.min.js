/*! woocommerce-name-your-price 3.2.1 */

function woocommerce_nyp_format_price(t,i,e){void 0===i&&(i=""),void 0===e&&(e=!1);e=e?woocommerce_nyp_params.currency_format:"%v";return accounting.formatMoney(t,{symbol:i,decimal:woocommerce_nyp_params.currency_format_decimal_sep,thousand:woocommerce_nyp_params.currency_format_thousand_sep,precision:woocommerce_nyp_params.currency_format_num_decimals,format:e}).trim()}function woocommerce_nyp_unformat_price(t){return Math.abs(parseFloat(accounting.unformat(t,woocommerce_nyp_params.currency_format_decimal_sep)))}jQuery.fn.wc_nyp_get_script_object=function(){var t=jQuery(this);return void 0!==t.data("wc_nyp_script_obj")&&t.data("wc_nyp_script_obj")},function(n){function e(t){if(nyp_script_object=t.wc_nyp_get_script_object())return nyp_script_object;this.$el=t,this.$add_to_cart=t.find(".single_add_to_cart_button"),this.$add_to_cart.length||(this.$add_to_cart=t.find(":submit")),this.$addons_totals=this.$el.find("#product-addons-total"),this.show_addons_totals=!1,this.nypProducts=[],this.update_nyp_timer=!1,this.$el.trigger("wc-nyp-initializing",[this]),this.updateForm=this.updateForm.bind(this),this.$add_to_cart.on("click",{nypForm:this},this.onSubmit),this.$el.on("wc-nyp-initialized",{nypForm:this},this.updateForm),this.$el.on("wc-nyp-updated",{nypForm:this},this.updateForm),this.initIntegrations(),this.$el.data("wc_nyp_script_obj",this),this.$el.trigger("wc-nyp-initialized",[this])}e.prototype.getProducts=function(){var r=this;return this.$el.find(".nyp").each(function(t){var i=n(this),e=(e=i.wc_nyp_get_script_object())||new o(i);r.nypProducts[t]=e}),r.nypProducts},e.prototype.initIntegrations=function(){this.$el.hasClass("variations_form")&&new t(this),this.$el.hasClass("grouped_form")&&new i(this),n("#woo_pp_ec_button_product").length&&new r(this)},e.prototype.updateForm=function(t,i){var e=t.data.nypForm;clearTimeout(e.update_nyp_timer),e.update_nyp_timer=setTimeout(function(){e.updateFormTask(i)},10)},e.prototype.updateFormTask=function(t){var i,e,r=this.getProducts();void 0===t&&void 0!==r&&r.length&&(t=r.shift()),void 0!==t&&void 0!==t.$price_input&&(e=t.$price_input.attr("name"),i=t.user_price,this.$add_to_cart.data(e,i),this.$addons_totals.data("price",i),this.$el.trigger("woocommerce-product-addons-update")),this.isValid()?(this.$add_to_cart.removeClass("nyp-disabled"),this.$el.trigger("wc-nyp-valid",[this])):(this.$add_to_cart.addClass("nyp-disabled"),this.$el.trigger("wc-nyp-invalid",[this]))},e.prototype.onSubmit=function(t){if(!t.data.nypForm.isValid("submit"))return t.preventDefault(),t.stopImmediatePropagation(),!1},e.prototype.isValid=function(i){var e=!0;return this.getProducts().forEach(function(t){if("submit"===i&&t.$el.trigger("wc-nyp-update"),!t.isValid())return!(e=!1)}),e},e.prototype.shutdown=function(){this.$el.find("*").off()};var o=function(t){if(nyp_script_object=t.wc_nyp_get_script_object())return nyp_script_object;var i=this;i.$el=t,i.$cart=t.closest(".cart"),i.$form=t.closest(".cart").not(".product, [data-bundled_item_id]"),i.$error=t.find(".woocommerce-nyp-message"),i.$error_content=i.$error.find("ul.woocommerce-error"),i.$label=t.find("label"),i.$screen_reader=t.find(".screen-reader-text"),i.$price_input=t.find(".nyp-input"),i.$period_input=t.find(".nyp-period"),i.$minimum=t.find(".minimum-price"),i.$subscription_terms=t.find(".subscription-details"),i.form=i.$form.wc_nyp_get_script_object(),i.min_price=parseFloat(t.data("min-price")),i.max_price=parseFloat(t.data("max-price")),i.annual_minimum=parseFloat(t.data("annual-minimum")),i.raw_price=i.$price_input.val(),i.user_price=woocommerce_nyp_unformat_price(i.raw_price),i.user_period=i.$period_input.val(),i.error_messages=[],i.optional=!1,i.initialized=!1,i.onUpdate=i.onUpdate.bind(i),i.validate=i.validate.bind(i),this.$el.on("change",".nyp-input, .nyp-period",{nypProduct:this},this.onChange),this.$el.on("keypress",".nyp-input, .nyp-period",{nypProduct:this},this.onKeypress),this.$el.on("woocommerce-nyp-update",{nypProduct:this},this.onUpdate),this.$el.on("wc-nyp-update",{nypProduct:this},this.onUpdate),i.$el.data("wc_nyp_script_obj",i),i.$el.trigger("wc-nyp-update",[i])};function t(n){var o=this,a=n.getProducts().shift(),t=n.$add_to_cart.html();this.integrate=function(){n.$el.on("found_variation",o.onFoundVariation),n.$el.on("reset_image",o.resetVariations),n.$el.on("click",".reset_variations",o.resetVariations)},this.onFoundVariation=function(t,i){var e,r;a.$error.slideUp(),null!=typeof i.is_nyp&&1==i.is_nyp?(n.$add_to_cart.html(i.add_to_cart_text),e=void 0!==i.display_price&&i.display_price?i.display_price:"",a.min_price=void 0!==i.minimum_price&&i.minimum_price?parseFloat(i.minimum_price):"",a.max_price=void 0!==i.maximum_price&&i.maximum_price?parseFloat(i.maximum_price):"",""!==e.trim()?a.$price_input.val(woocommerce_nyp_format_price(e)):a.$price_input.val(""),a.$label.length&&((r="undefined"!==i.price_label?i.price_label:"")?a.$label.html(r).show():a.$label.empty().hide()),a.$minimum.length&&((r="undefined"!==i.minimum_price_html?i.minimum_price_html:"")?a.$minimum.html(r).show():a.$minimum.empty().hide()),a.$el.slideDown(),a.$el.data("hide-minimum",i.hide_minimum),a.initialized=!1,a.$el.trigger("wc-nyp-update")):o.resetVariations()},this.resetVariations=function(){n.$add_to_cart.html(t).removeClass("nyp-disabled"),a.$el.slideUp().removeClass("nyp-error"),a.initialized=!1,a.$error_content.empty(),a.$price_input.val("")},this.integrate()}function i(t){var i=this;this.integrate=function(){t.$el.on("change",".qty, .wc-grouped-product-add-to-cart-checkbox",i.onStatusChange),t.$el.find(".qty, .wc-grouped-product-add-to-cart-checkbox").trigger("change")},this.onStatusChange=function(){var t=n(this).closest("tr").find(".nyp");t.length&&((n(this).is(":checkbox")?n(this).is(":checked"):0<n(this).val())?t.data("optional_status",!0):t.data("optional_status",!1),t.trigger("wc-nyp-update",[{force:!0}]))},this.integrate()}function r(t){var i=this;this.integrate=function(){t.$el.on("wc-nyp-valid",i.enable),t.$el.on("wc-nyp-invalid",i.disable),n(document).on("wc_ppec_validate_product_form",i.validate)},this.enable=function(t){n("#woo_pp_ec_button_product").trigger("enable")},this.disable=function(t){n("#woo_pp_ec_button_product").trigger("disable")},this.validate=function(t,i,e){e=e.wc_nyp_get_script_object();return"object"==typeof e&&(i=e.isValid()),i},this.integrate()}o.prototype.onChange=function(t){t.data.nypProduct.$el.trigger("wc-nyp-update",[t.data.nypProduct])},o.prototype.onKeypress=function(t){"Enter"===t.key&&(t.preventDefault(),t.data.nypProduct.$el.trigger("wc-nyp-update",[t.data.nypProduct]))},o.prototype.onUpdate=function(t,i){var e,r=this;void 0!==i&&i.hasOwnProperty("force")&&!0===i.force&&(this.initialized=!1),this.raw_price=this.$price_input.val().trim()?this.$price_input.val().trim():"",this.user_price=woocommerce_nyp_unformat_price(this.raw_price),this.user_period=this.$period_input.val(),""!==this.raw_price&&this.$price_input.val(woocommerce_nyp_format_price(this.user_price)),this.validate(),this.$el.data("price",this.user_price),this.$el.data("period",this.user_period),this.isValid()?(this.$el.removeClass("nyp-error"),this.$error.slideUp(),this.$el.trigger("wc-nyp-valid-item",[this])):(e=n("<ul/>"),0<(i=this.getErrorMessages()).length&&n.each(i,function(t,i){e.append(n("<li/>").html(i))}),this.$error_content.html(e.html()),this.$el.trigger("wc-nyp-invalid-item",[this])),this.isInitialized()&&!this.isValid()&&(this.$el.addClass("nyp-error"),this.$error.slideDown(function(){r.$price_input.trigger("focus").trigger("select")})),this.$cart.trigger("woocommerce-nyp-updated-item"),n("body").trigger("woocommerce-nyp-updated"),this.$el.trigger("wc-nyp-updated",[this]),this.initialized=!0},o.prototype.validate=function(){if(!this.priceChanged())return!0;if(this.resetMessages(),this.$el.data("nyp-valid",!0),this.isOptional())return!0;var t,i,e=this.$el.data("hide-minimum")?this.$el.data("hide-minimum-error"):this.$el.data("minimum-error"),r="%%MINIMUM%%",n="";0<this.annual_minimum?(form_annulualized_price=this.user_price*woocommerce_nyp_params.annual_price_factors[this.user_period],form_annulualized_price<this.annual_minimum&&(t=this.annual_minimum/woocommerce_nyp_params.annual_price_factors[this.user_period],i=this.$period_input.find('option[value="'+this.user_period+'"]').text(),n=woocommerce_nyp_params.i18n_subscription_string.replace("%price",woocommerce_nyp_format_price(t,woocommerce_nyp_params.currency_format_symbol,!0)).replace("%period",i),this.addErrorMessage(e.replace(r,n)))):this.min_price&&this.user_price<this.min_price?(n=woocommerce_nyp_format_price(this.min_price,woocommerce_nyp_params.currency_format_symbol,!0),this.addErrorMessage(e.replace(r,n))):this.max_price&&this.user_price>this.max_price?(e=this.$el.data("maximum-error"),r="%%MAXIMUM%%",n=woocommerce_nyp_format_price(this.max_price,woocommerce_nyp_params.currency_format_symbol,!0),this.addErrorMessage(e.replace(r,n))):""===this.raw_price&&(e=this.$el.data("empty-error"),this.addErrorMessage(e.replace(r,n))),this.isValid()||this.$el.data("nyp-valid",!1)},o.prototype.priceChanged=function(){return $changed=!0,(!this.$el.is(":visible")||this.isInitialized()&&this.raw_price===this.user_price&&this.user_price===this.$el.data("price")&&this.user_period===this.$el.data("period"))&&($changed=!1),$changed},o.prototype.isValid=function(){return!this.$el.is(":visible")||this.isOptional()||!this.error_messages.length},o.prototype.isOptional=function(){return"yes"===this.$el.data("optional")&&!1===this.$el.data("optional_status")},o.prototype.isInitialized=function(){return this.initialized},o.prototype.addErrorMessage=function(t){this.error_messages.push(t.toString())},o.prototype.getErrorMessages=function(t){return this.error_messages},o.prototype.resetMessages=function(){this.error_messages=[]},o.prototype.resetMessages=function(){this.error_messages=[]},o.prototype.getPrice=function(){return this.user_price},o.prototype.getPeriod=function(){return this.user_period},jQuery(function(a){a.fn.wc_nyp_form=function(){var t=a(this),i=t.wc_nyp_get_script_object();return!!t.hasClass("cart")&&(i&&t.data("wc_nyp_script_obj").shutdown(),new e(t),this)},a("form.cart").each(function(){a(this).wc_nyp_form()}),new e(a("form.cart")),a("body").on("quick-view-displayed",function(){a("form.cart").each(function(){a(this).wc_nyp_form()})}),a(".wcopc .cart").each(function(){a(this).wc_nyp_form()}),a("body").on("opc_add_remove_product",function(t,i,e,r){var n,o;return void 0===e||(o=(n=a(e.currentTarget)).closest(".cart").find(".nyp").wc_nyp_get_script_object())&&(o.$el.trigger("wc-nyp-update"),0<(e=parseFloat(i.quantity))&&!o.isValid()?("number"===n.prop("type")&&n.val(n.data("cart_quantity")),i.invalid=!0):0===e&&(o.$el.removeClass("nyp-error"),o.$error.slideUp(),e=o.$el.data("initial-price"),""!==a.trim(e)?o.$price_input.val(woocommerce_nyp_format_price(e)):o.$price_input.val(""))),i}),a("body .component").on("wc-composite-component-loaded",function(){var t=a(this).find(".nyp");t.length?new o(t):a(this).trigger("wc-nyp-updated")})})}(jQuery);